set(TML_PROJECT_DIR "${TORCH_ROOT_DIR}/TML")

set(TML_OUTPUT_DIR "${TORCH_PROJRECT_DIR}/lib/${TORCH_PLATFORM_NAME}")

set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${TML_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_DEBUG ${TML_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELEASE ${TML_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO ${TML_OUTPUT_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_MINSIZEREL ${TML_OUTPUT_DIR})

set(LIB_NAME TML)

set(BASE_HEADER_FILES
    ${TML_PROJECT_DIR}/include/TML/TML.hpp
	${TML_PROJECT_DIR}/include/TML/Compiler.hpp
	${TML_PROJECT_DIR}/include/TML/Config.hpp
	${TML_PROJECT_DIR}/include/TML/Platform.hpp
	${TML_PROJECT_DIR}/include/TML/Log.hpp
	${TML_PROJECT_DIR}/include/TML/Util.hpp
	${TML_PROJECT_DIR}/include/TML/DllLoader.hpp
	${TML_PROJECT_DIR}/include/TML/Thread.hpp
	${TML_PROJECT_DIR}/include/TML/Observable.hpp
	${TML_PROJECT_DIR}/include/TML/EventState.hpp
	${TML_PROJECT_DIR}/include/TML/Observer.hpp
	${TML_PROJECT_DIR}/include/TML/ResIdentifier.hpp
	${TML_PROJECT_DIR}/include/TML/Guid.hpp
	${TML_PROJECT_DIR}/include/TML/Random.hpp
	${TML_PROJECT_DIR}/include/TML/Hash.hpp
	${TML_PROJECT_DIR}/include/TML/StreamBuffer.hpp
	${TML_PROJECT_DIR}/include/TML/Color3.hpp
	${TML_PROJECT_DIR}/include/TML/Color4.hpp
)

set(BASE_SOURCE_FILES
	${TML_PROJECT_DIR}/src/Log.cpp
	${TML_PROJECT_DIR}/src/Util.cpp
	${TML_PROJECT_DIR}/src/DllLoader.cpp
	${TML_PROJECT_DIR}/src/Thread.cpp
	${TML_PROJECT_DIR}/src/EventState.cpp
	${TML_PROJECT_DIR}/src/ResIdentifier.cpp
	${TML_PROJECT_DIR}/src/Guid.cpp
	${TML_PROJECT_DIR}/src/StreamBuffer.cpp
	${TML_PROJECT_DIR}/src/Color3.cpp
	${TML_PROJECT_DIR}/src/Color4.cpp
)

SOURCE_GROUP("Base\\Source Files" FILES ${BASE_SOURCE_FILES})
SOURCE_GROUP("Base\\Header Files" FILES ${BASE_HEADER_FILES})

ADD_LIBRARY(${LIB_NAME} STATIC
	${BASE_SOURCE_FILES} ${BASE_HEADER_FILES}
)

target_compile_definitions(${LIB_NAME}
	PRIVATE
	-DTML_SOURCE
)

target_include_directories(${LIB_NAME}
	PUBLIC
	glm
	${TML_PROJECT_DIR}/include
)

SET(LIB_OUTPUT_NAME ${LIB_NAME}${TORCH_OUTPUT_SUFFIX})

SET_TARGET_PROPERTIES(${LIB_NAME} PROPERTIES
	PROJECT_LABEL ${LIB_NAME}
	OUTPUT_NAME ${LIB_OUTPUT_NAME}
	FOLDER "TML"
)


TORCH_ADD_PRECOMPILED_HEADER(${LIB_NAME} "${TML_PROJECT_DIR}/include/TML/TML.hpp")

target_link_libraries(${LIB_NAME}
	PUBLIC
		glm::glm
	PRIVATE
		rapidjson
)